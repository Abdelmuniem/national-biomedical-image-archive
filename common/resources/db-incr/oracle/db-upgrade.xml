<?xml version="1.0" encoding="UTF-8"?>

<databaseChangeLog xmlns="http://www.liquibase.org/xml/ns/dbchangelog/1.9"
                   xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
                   xsi:schemaLocation="http://www.liquibase.org/xml/ns/dbchangelog/1.9
                   http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-1.9.xsd">


  <preConditions> 
    <or>
      <dbms type="oracle" />
    </or>
  </preConditions>

  <changeSet id="5.0.test" author="kascice">        
    <comment>Need to have at least one changeset to allow tagging to work.</comment>
    <sql>select 'new_american_gospel_by_lamb_of_god_rules' from dual</sql>
  </changeSet>

   <changeSet id="5.1.ultrasound.general.image" author="Q.PAN">          
    <comment>Add frame number field.</comment>
    <addColumn tableName="general_image">
      <column name="US_FRAME_NUMBER" type="varchar(50)"/>
      <column name="US_COLOR_DATA_PRESENT" type="varchar(50)"/>
      <column name="US_IMAGE_TYPE" type="varchar(50)"/>
    </addColumn>
  </changeSet> 

  <changeSet id="5.1.ultrasound.general.image.2" author="Q.PAN">          
    <comment>Add US Modality</comment>
    <addColumn tableName="general_image">
      <column name="US_MULTI_MODALITY" type="varchar(50)"/>
    </addColumn>
  </changeSet>   
  
  <changeSet id="5.1.ultrasound.general.image.3" author="J.ZHOU">
    	<comment>drop column US_IMAGE_TYPE (duplicate column)</comment>
    	<dropColumn tableName="general_image" columnName="US_IMAGE_TYPE" />
  </changeSet>
  
  <changeSet id="aim.prototype.1" author="kascice">          
    <createTable tableName="aim_img_obs_characteristic">
      <column name="aim_img_obs_characteristic_pk_" type="bigint(20)">
        <constraints primaryKey="true" nullable="false"/>
      </column>   
      <column name="general_series_pk_id" type="bigint(20)">
        <constraints foreignKeyName="FK_AIM_IMG_OBS_SERIES_PK_ID"
                     references="general_series(general_series_pk_id)" 
                     nullable="false"/>
      </column>
      
      <column name="code_meaning_name" type="varchar(128)">
        <constraints nullable="false"/>
      </column>
      
      <column name="code_schema_designator" type="varchar(128)"> 
        <constraints nullable="false"/>
      </column>
      
      <column name="code_value" type="varchar(128)"> 
        <constraints nullable="false"/>
      </column>
      
    </createTable>  
    
    <createTable tableName="aim_quantification">
      <column name="aim_quantification_pk_id" type="bigint(20)">
        <constraints primaryKey="true" nullable="false"/>
      </column>   
      <column name="aim_img_obs_characteristic_pk_" type="bigint(20)">
        <constraints foreignKeyName="FK_AIM_IMG_OBS_CHARACTERISTIC_PK_ID"
                     references="aim_img_obs_characteristic(aim_img_obs_characteristic_pk_)" 
                     nullable="false"/>
      </column>
      
      <column name="type" type="varchar(10)">
        <constraints nullable="false"/>
      </column>
      
      <column name="name" type="varchar(255)">   
        <constraints nullable="false"/>
      </column>
      
      <column name="value" type="varchar(255)"> 
        <constraints nullable="false"/>
      </column>      

    </createTable>      
    
   </changeSet>  

</databaseChangeLog>
