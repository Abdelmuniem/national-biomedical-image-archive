<?xml version="1.0" encoding="UTF-8"?>

<!--L
   Copyright SAIC, Ellumen and RSNA (CTP)


   Distributed under the OSI-approved BSD 3-Clause License.
   See http://ncip.github.com/national-biomedical-image-archive/LICENSE.txt for details.
L-->

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" 
               "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<ui:composition xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:ice="http://www.icesoft.com/icefaces/component"
	xmlns:ncia="http://imaging.nci.nih.gov/ncia">
	
	
	<table cellspacing="0" cellpadding="0" width="100%" summary=""	border="0" valign="top">
	<tr>
	<h:form id="searchMenuForm">
	<td colspan="2">
	<table cellspacing="0" cellpadding="0" width="100%" summary=""	border="0" valign="top">
	<tr>
	<td align="center">
	<h:panelGroup>
	  <f:subview id="simpleSearchHelp" rendered="#{!searchWorkflowBean.advanced}">
		<h:commandButton action="#" image="images/simple-search.png" immediate="true" />
		 <ncia:help label="images/help_icon.png"	helpId="-performsimplesearch" />
		</f:subview>
		<f:subview id="textSearchHelp" rendered="#{searchWorkflowBean.advanced}">
		    <h:commandLink action="#" value="Text Search"	rendered="#{searchWorkflowBean.advanced}" immediate="true" />
		    <ncia:help label="images/help_icon.png"	helpId="-performsimplesearch" />
		</f:subview>
      	  </h:panelGroup>
      	</td>  
      	<td>
	      	  <ui:include src="../searchresults/searchResultButtons.xhtml">
	  	 </ui:include>
  	</td>
      	<td>
      	      <f:subview id="saveQueryView" rendered="#{!anonymousLoginBean.guestLoggedIn or searchWorkflowBean.dynamicSearch}">
	      <table width="100%" border="0" cellspacing="0" cellpadding="0">
	        <tr>
	          <td>
	            <div align="right">
	              <h:panelGrid columns="3" 
	                           rendered="#{searchWorkflowBean.query.savedQueryId == 0}">
	                <h:inputText id="queryName" 
	                             value="#{searchResultBean.queryName}"
	                             maxlength="200" 
	                             disabled="#{ispyBean.isQueryFromUrl}"/>
	                <h:commandLink id="saveQueryButton"
	                                 value="Save Query"
	                                 action="#{searchResultBean.saveQuery}" 
	                                 disabled="#{ispyBean.isQueryFromUrl}"/>
			<ncia:help label="images/help.gif" helpId="-worksavedsearchqueries" />          
	              </h:panelGrid>
	
	            </div>
	            <div align="center">
	              <h:panelGrid columns="1"
	                           rendered="#{searchWorkflowBean.editingSavedQuery}">
	                <h4>
	                  <h:outputText value="#{msg.search_saveQuery}" />
	                  <ncia:help label="images/help.gif" helpId="-editsavedqueries" />
	                </h4>
	                <h:panelGrid columns="2">
	                  <h:selectOneRadio value="#{searchResultBean.updateQuery}"
	                                    layout="pageDirection"
	                                    enabledClass="formMessage">
	                    <f:selectItem itemValue="true"
	                                  itemLabel="#{msg.search_updateQuery}#{searchResultBean.query.queryName}#{msg.search_newCriteria}" />
	                    <f:selectItem itemValue="false"
	                                  itemLabel="#{msg.search_saveQueryAs}" />
	                  </h:selectOneRadio>
	                  <h:panelGrid>
	                    <br/>
	                    <h:inputText id="newQueryName" 
	                                 value="#{searchResultBean.queryName}" 
	                                 maxlength="200" 
	                                 onfocus="javascript:selectRadio();"/>
	                  </h:panelGrid>
	
	                  <h:commandButton id="editingSaveQueryButton"
	                                   image="images/SAVEQUERY.gif" 
	                                   action="#{searchResultBean.saveQuery}" />
	                </h:panelGrid>
	              </h:panelGrid>
	              <h:inputHidden id="newDataQuery" value="true" />
	              <h:message for="newDataQuery" errorClass="errorLabel" infoClass="infoLabel" />
	              <h:message for="queryName" errorClass="errorLabel" infoClass="infoLabel" />
	              <h:message for="newQueryName" errorClass="errorLabel" infoClass="infoLabel" />
	            </div>
	          </td>
	        </tr>
	      </table>
      </f:subview>
      	</td>
      	
  	</tr>
  	</table>
  	</td>
      	</h:form>
		</tr>
		<tr>
			<f:subview id="simpleView" rendered="#{!searchWorkflowBean.advanced}">
			<td width="1%" valign="top">
				<h:form id="searchForm">
					<table  class="contentPage" cellspacing="0" cellpadding="0" width="100%" summary="" border="0" valign="top">
						<tr>
							<td>
							<ice:panelCollapsible expanded="true" rendered="true">
								 <f:facet name="header">
									<ice:panelGroup>
										<ice:outputText value=""/>
									</ice:panelGroup>
                						  </f:facet> 
							
								<f:subview id="collectionSearchCriteriaRow"
									rendered="#{searchLookupBean.showCollectionSearch}">
									<ui:include src="collectionSearchCriteria.xhtml" />
								</f:subview>
							
									<ice:panelCollapsible expanded="true" rendered="true">
									                <f:facet name="header">
									                  <ice:panelGroup>
									                    <ice:outputText value="#{msg.criteria_ImageModalityCriteria}"/>
									                  </ice:panelGroup>
                									</f:facet> 
									
											<f:subview id="modalityCriteria">
												
													
														
															<div id="modalitiesDiv" class="searchFormSelector">
																<h:dataTable id="modalityCheckboxesTable" width="100%"
																	border="0" cellpadding="0" cellspacing="0"
																	value="#{searchWorkflowBean.modalityItems}"
																	var="modalityItem">
																	<h:column id="modalityItemsColumn">
																		<span style="white-space: nowrap;"> 
																		<ice:selectBooleanCheckbox
																				value="#{modalityItem.value}"
																				valueChangeListener="#{searchWorkflowBean.modalityChangeListener}"
																				partialSubmit="true" />
																		<f:attribute
																				name="selectedItemLabel"
																				value="#{modalityItem.label}" /> <span
																			title="#{modalityItem.description}"> <h:outputText
																					value="#{modalityItem.label}" />
																		</span>
																		</span>
																	</h:column>
																</h:dataTable>
															</div>
														
													
													
														<f:subview id="usSearch"
																rendered="#{searchWorkflowBean.usSearch}">
																
																	
																		<h:outputText
																				value="#{msg.criteria_NumFrameOptionCriteria}" /> <h:selectManyCheckbox
																				id="numOfFrame" style="font-size: 1em"
																				value="#{searchWorkflowBean.numFrameOptions}"
																				layout="lineDirection">
																				<f:selectItems
																					value="#{searchLookupBean.numFrameOptionItems}" />
																			</h:selectManyCheckbox>
																	
																	
																		<h:outputText
																				value="Ultrasound Color Data Present (US)" /> <h:selectManyCheckbox
																				id="colorMode" style="font-size: 1em"
																				value="#{searchWorkflowBean.colorModeOptions}"
																				layout="lineDirection">
																				<f:selectItems
																					value="#{searchLookupBean.colorModeOptionItems}" />
																			</h:selectManyCheckbox>
																	
																	
																		<h:outputText
																				value="Ultrasound Image Mode (US)" />
																			<div id="imageTypeDiv" class="searchFormSelector"
																				align="center">
																				<h:dataTable id="imageTypeCheckboxesTable"
																					width="100%" border="0" cellpadding="0"
																					cellspacing="0"
																					value="#{searchWorkflowBean.usMultiModalityItems}"
																					var="imageTypeItem">
																					<h:column id="imageTypeItemsColumn">
																						<span style="white-space: nowrap;"> <ice:selectBooleanCheckbox
																								value="#{imageTypeItem.value}"
																								partialSubmit="true" /> <h:outputText
																								value="#{imageTypeItem.label}" />
																						</span>
																					</h:column>
																				</h:dataTable>
																			</div>
																	
																
															</f:subview>
													
												
											</f:subview>
										</ice:panelCollapsible>
						
						
							
							<f:subview id="anatomicCriteria"
									rendered="#{searchWorkflowBean.showAnatomicCriteria}">
									
										<ice:panelCollapsible expanded="true" rendered="true">
										
										
											<f:facet name="header">
											  <ice:panelGroup>
											    <ice:outputText id="collectionHeader" style="float:left;" value="#{msg.criteria_AnatomicalSiteCriteria}" />
											   
										
											    </ice:panelGroup>
											 </f:facet>
										
										
										
										
											<div id="anatomicalSitesDiv" class="searchFormSelector">
												<h:dataTable id="anatomicalSitesCheckboxesTable"
													width="100%" border="0" cellpadding="0" cellspacing="0"
													value="#{searchWorkflowBean.anatomicalSiteItems}"
													var="anatomicalSiteItem">
														<h:column id="anatomicalSiteItemsColumn">
															<span style="white-space: nowrap;"> 
															<ice:selectBooleanCheckbox 
																style="float:left;"
																value="#{anatomicalSiteItem.value}"
																partialSubmit="true" valueChangeListener="#{searchWorkflowBean.modalityChangeListener}"/> 
																	<h:outputText style="float:left;" value="#{anatomicalSiteItem.label}" />
															</span>
														</h:column>
												</h:dataTable>
											</div>
										
										
									</ice:panelCollapsible>	
									
								</f:subview>
								
								
						
		
		<f:verbatim>&amp;nbsp;</f:verbatim>
		<f:verbatim>&amp;nbsp;</f:verbatim>
		<f:verbatim>&amp;nbsp;</f:verbatim>
		<f:verbatim>&amp;nbsp;</f:verbatim>
		<f:verbatim>&amp;nbsp;</f:verbatim>
		<f:verbatim>&amp;nbsp;</f:verbatim>
		<f:verbatim>&amp;nbsp;</f:verbatim>
		
             
               <div id="resultsPerPageDiv" style="height: 40px;">
                <ice:outputLabel for="perPage" value="#{msg.search_resultsPerPage}" />
                
                 <span class="formFieldWhite">                        
                  <ice:selectOneMenu id="resultsPerPage" 
                                   value="#{searchWorkflowBean.resultPerPageOption}"
                                   style="margin-left: 15px"
                                   immediate="true"
                                   partialSubmit="true"
                                   valueChangeListener="#{searchWorkflowBean.resultPerPageOptionChangeListener}">
                    <f:selectItem itemValue="20" itemLabel="20" />
                    <f:selectItem itemValue="40" itemLabel="40"/>
                    <f:selectItem itemValue="60" itemLabel="60" />
                    <f:selectItem itemValue="100" itemLabel="100" />
                  </ice:selectOneMenu>
                </span>
                </div>
                </ice:panelCollapsible>
              </td>
            </tr>					
            </table>
					</h:form>
					</td>
					</f:subview>
					<f:subview id="advSubView2" rendered="#{searchWorkflowBean.advanced}">
					<td valign="top" width="10%">
					
					   <ui:include src="textSearchBody.xhtml" />
				</td>
				</f:subview>
			<td valign="top" width="90%" class="formField">
			<f:subview id="criteriaView" rendered="#{not empty searchResultBean.nodeTablesWrappers}">
			  <ui:include src="../searchresults/searchResult.xhtml" />
			</f:subview>
			<f:subview id="criteriaView" rendered="#{empty searchResultBean.nodeTablesWrappers}">
				<ice:outputText value="Select Criteria to search images" style="display:inline"/>
			</f:subview>
			</td>

		</tr>
	</table>

	<ice:form id="collectionDescriptionPopupForm">
		<ice:panelPopup id="collectionDescriptionPopup"
			style="z-index:999; background-color:#FFFFFF;" resizable="false"
			draggable="false" modal="true"
			visible="#{displayCollectionDescBean.collectionDescriptionPopupRendered}">

			<f:facet name="header">
				<ice:panelGroup styleClass="popupHeaderWrapper">
					<table width="100%">
						<tr>
							<td width="100%"><ice:outputText
									value="Description for #{displayCollectionDescBean.selectedCollectionLabel}" />
							</td>
							<td><ice:commandButton
									id="collectionDescriptionPopupCloseButton"
									image="images/cancel.png"
									action="#{displayCollectionDescBean.toggleCollectionDescriptionPopup}"
									title="Close Popup" /></td>
						</tr>
					</table>
				</ice:panelGroup>
			</f:facet>

			<f:facet name="body">
				<ice:panelGroup style="overflow: auto; width:400px; height: 200px">
					<ice:outputText
						value="#{displayCollectionDescBean.collectionDescription}"
						escape="false" />
				</ice:panelGroup>
			</f:facet>
		</ice:panelPopup>
	</ice:form>

</ui:composition>
